# FFUI v0.2.0

Full Changelog: https://github.com/muyuanjin/ffui/compare/v0.1.1...v0.2.0

## English

### Highlights
- Output Policy: control output directory, container format, filename rules (prefix/suffix, regex replace, timestamp/quality/random tags), and optional file-time preservation.
- Safer queue workflows: new crash-recovery modes, clearer global warnings, and better pause/resume behaviour.
- Desktop experience: in-app updates (Tauri updater), plus single-instance protection to prevent accidental duplicate launches.
- Appearance: improved system font picker and queue selection bar; new appearance settings for UI customization.
- Performance: optimized queue snapshot hot path for smoother large-queue updates.

### Details
- Output Policy
  - Configure how output filenames are generated (append order preview + hover preview) and batch enqueue with the chosen policy.
  - Optionally keep input container, force a specific format, or keep the default behavior per preset/task.
- Reliability
  - Adds crash recovery modes and retains terminal logs for easier post-mortem debugging.
  - Hardens resume handling to isolate segments and avoid duplicate input locking.
- Desktop & updates
  - Enables Tauri updater-based in-app updates (portable Windows `.exe` is still a separate artifact).
  - Adds a per-executable single-instance guard (fail-closed) with UDP lock-info test coverage.
- Release/CI maintenance
  - Release workflow can sync existing release metadata when re-running on the same tag.

### Commit summary
- ci(release): sync existing release metadata on tag reruns
- docs: update image formats in README to WebP
- docs(readme): add badges and download button
- perf: optimize queue snapshot hot path
- feat: add crash recovery modes and terminal log retention
- fix(engine): isolate resume segments and lock duplicate inputs
- fix(ui): surface queue warnings in global alerts
- ckpt: [req-20251213-single-instance-per-executable | Task T1/1] add per-exe single-instance guard — block duplicates and focus
- fix: make single-instance guard fail closed
- ckpt: [req-20251213-single-instance-per-executable | Task T2/2] add cross-platform CI workflow — validate on mac/linux/win
- test: cover single-instance UDP and lock-info
- ckpt: recover stash@{0} settings UI layout
- feat: enable in-app updates via Tauri updater
- fix: prevent pause/resume overlap and persist selection pin
- feat: add UI appearance settings and docs screenshot tooling
- fix: improve system font picker and queue selection bar
- feat: add output policy for queue and Smart Scan
- feat: add output policy preview and append-order controls
- feat: preview output policy and batch enqueue jobs
- feat: enhance output policy hover preview and format selection UI

## 中文

### 重点更新
- 输出策略（Output Policy）：可配置输出目录、封装格式、文件名规则（前/后缀、正则替换、时间/质量/随机后缀），并可选择保留文件时间戳。
- 队列更稳：新增崩溃恢复模式与终端日志保留；全局告警更清晰；暂停/继续行为更可靠。
- 桌面体验：支持应用内更新（Tauri updater）；新增单实例保护，避免误启动多个窗口。
- 外观设置：系统字体选择器与队列选择栏体验改进；新增外观相关设置用于自定义 UI。
- 性能优化：优化队列快照热路径，大队列刷新更顺滑。

### 细节说明
- 输出策略（Output Policy）
  - 支持预览文件名拼接顺序与悬浮预览，并可按所选策略批量入队。
  - 可选择保持输入封装、强制指定格式，或沿用各预设/任务默认行为。
- 可靠性
  - 新增崩溃恢复模式，并保留终端日志以便排查问题。
  - 强化续传/恢复处理：隔离分段并避免重复输入锁定。
- 桌面与更新
  - 启用基于 Tauri updater 的应用内更新（Windows portable `.exe` 仍作为单独产物发布）。
  - 新增“按可执行文件粒度”的单实例守护（失败时默认拒绝第二实例），并补充 UDP lock-info 相关测试。
- 发布/CI 维护
  - Release 工作流在同一 tag 重跑时可同步既有 Release 的 notes 与 target commitish。

### 提交摘要
- ci(release): sync existing release metadata on tag reruns
- docs: update image formats in README to WebP
- docs(readme): add badges and download button
- perf: optimize queue snapshot hot path
- feat: add crash recovery modes and terminal log retention
- fix(engine): isolate resume segments and lock duplicate inputs
- fix(ui): surface queue warnings in global alerts
- ckpt: [req-20251213-single-instance-per-executable | Task T1/1] add per-exe single-instance guard — block duplicates and focus
- fix: make single-instance guard fail closed
- ckpt: [req-20251213-single-instance-per-executable | Task T2/2] add cross-platform CI workflow — validate on mac/linux/win
- test: cover single-instance UDP and lock-info
- ckpt: recover stash@{0} settings UI layout
- feat: enable in-app updates via Tauri updater
- fix: prevent pause/resume overlap and persist selection pin
- feat: add UI appearance settings and docs screenshot tooling
- fix: improve system font picker and queue selection bar
- feat: add output policy for queue and Smart Scan
- feat: add output policy preview and append-order controls
- feat: preview output policy and batch enqueue jobs
- feat: enhance output policy hover preview and format selection UI
