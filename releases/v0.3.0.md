# FFUI v0.3.0

Full Changelog: https://github.com/muyuanjin/ffui/compare/v0.2.1...v0.3.0

## English

### Key Updates

- More precise pause/resume: More stable resume from launch and crash, more reliable progress correction.
- Significant performance improvement for large queues: Virtualization of list/icon views, incremental status synchronization (delta sync), smoother drag and reordering.
- Safer and clearer batch operations: More consistent selection interaction, clearer feedback, support for batch waiting and safer batch deletion.
- Polished UI experience: View-adaptive preview thumbnails; reduced preview flickering/clipping issues; command highlighting cache; main interface Tab lazy loading for faster startup.
- Reinforced crash/exit recovery, enhanced proxy and updater capabilities (SOCKS5 + failover to direct connection), as well as pnpm migration and check/maintenance, backend reinforcement, performance/screenshot regression tools, etc.

### Detailed Explanation

- Pause/Resume and Recovery
  - Strengthened launch recovery and crash resume processes, expanded engine/state recovery coverage, and added bench/tests.
  - Stabilized progress updates, and provided best-effort correction based on real-time progress samples (protected by telemetry data).
  - Maintained pause/resume reinforcement: segment target tracking/rollback, safer concat, stable boundary metadata, stderr drain, and stricter cleanup/trim logic.
  - Unified "pause and exit" behavior with batch pausing, reducing unexpected differences.
- Queue and Performance
  - Virtualization of queue panel and icon view, maintaining smooth responsiveness with large queues.
  - Introduced lite deltas + incremental synchronization, reducing UI jitter and lag during large batch updates.
  - Reinforced batch operations (atomic worker handoff, snapshot revision waiting after batch operations, accelerated batch deletion), and smoothed queue list reordering.
  - Enhanced filtering/selection behavior (including "clear selection on blank click") and batch operation feedback experience.
  - Improved sorting interaction and preview-related queue behavior with large queues.
- Preview and Interface
  - Preheated previews at startup and automatically replenished missing video previews; limited dialog overflow and deduplicated native errors.
  - Avoided preview flickering/clipping, and refreshed startup splash screen.
  - Main interface Tab lazy loading; command highlighting render result caching to reduce UI overhead.
  - View-adaptive preview thumbnails; loaded queue previews during runtime.
- Tools, Network and Updates
  - Maintained proxy/updater capabilities: SOCKS5 proxy URL, proxy failure failover to direct connection, updater proxy override, and updater settings persistence.
  - Fixed URL loss when switching proxy modes; improved tool download progress/size detection and download status stability.
- Platform and Maintenance
  - Backend anti-panic reinforcement; `withGlobalTauri` disabled by default; improved Windows Job Object handle management.
  - Migrated to pnpm; stabilized check-all/format checking; adjusted jscpd threshold; supplemented performance/screenshot auxiliary scripts.
  - Extended performance/screenshot regression scripts and harness for regression testing.

## 中文

### 重点更新

- 暂停/中断后续转更精准：启动恢复与崩溃续转更稳，进度纠偏更可靠。
- 大队列性能显著提升：列表/图标视图虚拟化、增量状态同步，拖拽/重排更顺滑。
- 批量操作更安全、更清晰：选择交互更一致、反馈更明确，支持批量等待与更安全的批量删除。
- 界面体验打磨：按视图自适应预览缩略图；减少预览闪烁/裁切问题；命令高亮缓存；主界面 Tab 懒加载以加快启动。
- 崩溃/退出恢复加固、代理与更新器能力增强（SOCKS5 + 失败回退直连）、以及 pnpm 迁移与检查/维护、后端加固、性能/截图回归工具等。

### 细节说明

- 暂停/续传与恢复
  - 强化启动恢复与崩溃续转流程，扩展引擎/状态恢复覆盖范围，并补齐 bench/测试。
  - 稳定进度更新，并提供基于实时进度样本的 best-effort 纠偏（由遥测数据进行保护性开关）。
  - 保留暂停/续传加固：segment target 追踪/回滚、更安全的 concat、boundary metadata 稳定、stderr drain、以及更严格的清理/trim 逻辑。
  - 让“暂停并退出”的行为与批量暂停保持一致，减少意外差异。
- 队列与性能
  - 队列面板与图标视图虚拟化，在大队列下也能保持流畅响应。
  - 引入 lite deltas + 增量同步，降低大批量更新时的 UI 抖动与卡顿。
  - 加固批量操作（atomic worker handoff、批量操作后的快照修订等待、批量删除加速），并平滑执行队列列表重排。
  - 增强筛选/选择行为（含“空白处点击清空选择”）与批量操作反馈体验。
  - 改进排序交互与大队列下与预览相关的队列行为。
- 预览与界面
  - 启动时预热预览并自动补齐缺失的视频预览；限制对话框溢出并去重 native 错误。
  - 避免预览闪烁/裁切，并刷新启动闪屏。
  - 主界面 Tab 懒加载；命令高亮渲染结果缓存以降低 UI 开销。
  - 按视图自适应预览缩略图；运行中加载队列预览。
- 工具、网络与更新
  - 保留代理/更新器能力：SOCKS5 代理 URL、代理失败回退直连、更新器代理覆盖，以及更新器设置持久化。
  - 修复切换代理模式时 URL 丢失；改进工具下载进度/大小探测与下载状态稳定性。
- 平台与维护
  - 后端防 panic 加固；默认禁用 `withGlobalTauri`；改善 Windows Job Object 句柄管理。
  - 迁移至 pnpm；稳定 check-all/格式检查；调整 jscpd 阈值；补充性能/截图辅助脚本。
  - 扩展性能/截图回归脚本与 harness，方便做回归验证。
